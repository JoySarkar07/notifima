"use strict";jQuery((function(a){function e(e){e.preventDefault();let i=a(this).closest(".notifima-subscribe-form");a(this).text(localizeData.processing),a(this).addClass("stk_disabled");if(localizeData.recaptcha_enabled){const e=i.find("#recaptchav3_secretkey").val(),s=i.find("#recaptchav3_response").val(),o={action:"recaptcha_validate_ajax",nonce:localizeData.nonce,recaptcha_secret:e,recaptcha_response:s};a.post(localizeData.ajax_url,o,(function(e){e?t(i):(alert("Oops, recaptcha not verified!"),a(this).removeClass("stk_disabled"))}))}else t(i)}function t(e){let t=e.find(".notifima-email").val(),i=e.find(".current-product-id").val(),s=e.find(".current-variation-id").val(),o=e.find(".current-product-name").val(),l=localizeData.button_html,r=localizeData.alert_success,c=localizeData.error_occurs,n=localizeData.try_again,d=localizeData.alert_email_exist,u=localizeData.valid_email,m=localizeData.ban_email_domain_text,_=localizeData.ban_email_address_text,p=localizeData.double_opt_in_success,f=localizeData.unsubscribe_button;if(r=r.replace("%product_title%",o),r=r.replace("%customer_email%",t),d=d.replace("%product_title%",o),d=d.replace("%customer_email%",t),function(a){if(!a)return!1;return/^([a-zA-Z0-9_\.\-\+])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/.test(a)}(t)){a(this).toggleClass("alert_loader").blur();let o={action:"alert_ajax",nonce:localizeData.nonce,customer_email:t,product_id:i,variation_id:s};localizeData.additional_fields.forEach((e=>{o[e]=a("#notifima_"+e).val()})),a.post(localizeData.ajax_url,o,(function(o){"0"==o?e.html(`<div class="registered-message"> ${c} <a href="${window.location}"> ${n} </a></div>`):"/*?%already_registered%?*/"==o?e.html(`<div class="registered-message">${d}</div>${f}<input type="hidden" class="subscribed_email" value="${t}" /><input type="hidden" class="product_id" value="${i}" /><input type="hidden" class="variation_id" value="${s}" />`):"/*?%ban_email_address%?*/"==o?e.find(".responsedata-error-message").remove()&&e.append(a(`<p class="responsedata-error-message ban-email-address">${_}</p>`)):"/*?%ban_email_domain%?*/"==o?e.find(".responsedata-error-message").remove()&&e.append(a(`<p class="responsedata-error-message ban-email-address">${m}</p>`)):"/*?%double_opt_in%?*/"==o?e.html(`<div class="registered-message"> ${p}</div>`):e.html(`<div class="registered-message">${r}</div>`),e.find(".notifima-button").replaceWith(l)}))}else e.find(".responsedata-error-message").remove()&&e.append(a(`<p style="color:#e2401c;" class="responsedata-error-message">${u}</p>`)),e.find(".notifima-button").replaceWith(l)}function i(e){e.preventDefault();let t=a(this).parent().parent();a(this).text(localizeData.processing),a(this).addClass("stk_disabled");const i={action:"unsubscribe_button",nonce:localizeData.nonce,customer_email:t.find(".subscribed_email").val(),product_id:t.find(".product_id").val(),variation_id:t.find(".variation_id").val()};let s=localizeData.alert_unsubscribe_message;s=s.replace("%customer_email%",i.customer_email);let o=localizeData.error_occurs;a.post(localizeData.ajax_url,i,(function(e){e?t.html(`<div class="registered-message"> ${s}</div>`):t.html(`<div class="registered-message"> ${o}<a href="${window.location}"> ${localizeData.try_again}</a></div>`),a(this).removeClass("stk_disabled")}))}function s(){const e=Number(a(this).val()),t=Number(a(".notifima-shortcode-subscribe-form").data("product-id"));if(a(".notifima-shortcode-subscribe-form").length&&e){const i={action:"get_variation_box_ajax",nonce:localizeData.nonce,product_id:t,variation_id:e};a.post(localizeData.ajax_url,i,(function(e){a(".notifima-shortcode-subscribe-form").html(e)}))}else a(".notifima-shortcode-subscribe-form").html("")}a(document).on("click",".notifima-button",e),a(document).on("click",".unsubscribe-button",i),a(document).on("change","input.variation_id",s)}));